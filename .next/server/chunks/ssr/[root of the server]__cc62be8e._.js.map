{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 55, "column": 0}, "map": {"version":3,"sources":["file:///Users/pkieras/Desktop/test%20viisp/viisp_fe/src/pages/_document.tsx"],"sourcesContent":["import { Html, Head, Main, NextScript } from \"next/document\";\n\nexport default function Document() {\n  return (\n    <Html lang=\"en\">\n      <Head />\n      <body className=\"antialiased\">\n        <Main />\n        <NextScript />\n      </body>\n    </Html>\n  );\n}\n"],"names":[],"mappings":";;;;AAAA;;;AAEe,SAAS;IACtB,qBACE,qKAAC,yHAAA,CAAA,OAAI;QAAC,MAAK;;0BACT,qKAAC,yHAAA,CAAA,OAAI;;;;;0BACL,qKAAC;gBAAK,WAAU;;kCACd,qKAAC,yHAAA,CAAA,OAAI;;;;;kCACL,qKAAC,yHAAA,CAAA,aAAU;;;;;;;;;;;;;;;;;AAInB","debugId":null}},
    {"offset": {"line": 103, "column": 0}, "map": {"version":3,"sources":["file:///Users/pkieras/Desktop/test%20viisp/viisp_fe/src/pages/_app.tsx"],"sourcesContent":["import \"@/styles/globals.css\";\nimport type { AppProps } from \"next/app\";\n\nexport default function App({ Component, pageProps }: AppProps) {\n  return <Component {...pageProps} />;\n}\n"],"names":[],"mappings":";;;;;;AAGe,SAAS,IAAI,EAAE,SAAS,EAAE,SAAS,EAAY;IAC5D,qBAAO,qKAAC;QAAW,GAAG,SAAS;;;;;;AACjC","debugId":null}},
    {"offset": {"line": 134, "column": 0}, "map": {"version":3,"sources":["file:///Users/pkieras/Desktop/test%20viisp/viisp_fe/src/pages/index.tsx"],"sourcesContent":["import { useEffect, useState } from 'react';\nimport axios from 'axios';\n\nexport default function Home() {\n  const [data, setData] = useState(null);\n  const [userInfo, setUserInfo] = useState({ name: '', country: '' });\n  const [ticket, setTicket] = useState(null);\n  const [error, setError] = useState(null);\n  const [tokenData, setTokenData] = useState(null);\n\n  const fetchData = async () => {\n    try {\n      const token = sessionStorage.getItem('jwt');\n      const response = await axios.get('http://localhost:3001/api/data', {\n        headers: {\n          Authorization: `Bearer ${token}`\n        }\n      });\n      setData(response.data);\n    } catch (error) {\n      console.log(error);\n      if (error.response && error.response.status === 401) {\n        try {\n          if(ticket === null){\n            const ticketResponse = await axios.post('http://localhost:3001/api/ticket');\n            setTicket(ticketResponse.data.ticket);\n          }\n        } catch (ticketError) {\n          setError('Failed to obtain ticket');\n        }\n      } else {\n        setError('Failed to fetch data');\n      }\n    }\n  };\n\n  const fetchUserInfo = async () => {\n    try {\n      const token = sessionStorage.getItem('jwt');\n      const response = await axios.get('http://localhost:3001/api/info', {\n        headers: {\n          Authorization: `Bearer ${token}`\n        }\n      });\n      setUserInfo(response.data);\n    } catch (error) {\n      console.log('Failed to fetch user info', error);\n    }\n  };\n\n  useEffect(() => {\n    fetchData();\n    fetchUserInfo();\n  }, []);\n\n  useEffect(() => {\n    if (ticket) {\n      const interval = setInterval(async () => {\n        try {\n          const tokenResponse = await axios.post(`http://localhost:3001/api/token`, {\n            ticketId: ticket\n          });\n          if (tokenResponse.status === 200) {\n            sessionStorage.setItem('jwt', tokenResponse.data);\n            setTokenData(tokenResponse.data);\n            clearInterval(interval);\n          }\n        } catch {\n          // Handle polling errors if necessary\n        }\n      }, 5000);\n\n      return () => clearInterval(interval);\n    }\n  }, [ticket]);\n\n  useEffect(() => {\n    if (tokenData) {\n      fetchData();\n      fetchUserInfo();\n    }\n  }, [tokenData]);\n\n  // Polling for data every 5 seconds\n  // useEffect(() => {\n  //   const interval = setInterval(() => {\n  //     fetchData();\n  //   }, 5000);\n\n  //   return () => clearInterval(interval);\n  // }, []);\n\n  const handleLogout = () => {\n    sessionStorage.removeItem('jwt');\n    setData(null);\n    setUserInfo({ name: '', country: '' });\n    setTicket(null);\n    setTokenData(null);\n\n    // Refresh the page\n    window.location.reload();\n  };\n\n  if (error) {\n    return <div className=\"text-red-500\">Error: {error}</div>;\n  }\n\n  if (!data) {\n    if (ticket) {\n      return (\n        <div className=\"p-4\">\n          <h1 className=\"text-xl font-bold mb-4\">Informacija prieinama tik patvirtinus savo tapatybÄ™</h1>\n          <form\n            action=\"https://test.epaslaugos.lt/portal/external/services/authentication/v2/\"\n            method=\"post\"\n            target=\"_blank\"\n            className=\"flex flex-col items-start\">\n            <input name=\"ticket\" value={ticket} type=\"hidden\" />\n            <button\n              type=\"submit\"\n              className=\"bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-600 transition duration-200\">\n              Prisijungti per VIISP\n            </button>\n          </form>\n        </div>\n      );\n    } else {\n      return <div className=\"text-gray-500\">Loading...</div>;\n    }\n  }\n\n  return (\n    <div className=\"p-4\">\n      <h1 className=\"text-xl font-bold mb-4\">\n        {userInfo.name}, {userInfo.country}\n      </h1>\n      <table className=\"min-w-full bg-white border border-gray-200\">\n        <thead>\n          <tr>\n            <th className=\"border px-4 py-2\">Kodas</th>\n            <th className=\"border px-4 py-2\">Miestas</th>\n            <th className=\"border px-4 py-2\">Imone</th>\n          </tr>\n        </thead>\n        <tbody>\n          {data.map((item, index) => (\n            <tr key={index}>\n              <td className=\"border px-4 py-2\">{item.kodas}</td>\n              <td className=\"border px-4 py-2\">{item.miestas}</td>\n              <td className=\"border px-4 py-2\">{item.imone}</td>\n            </tr>\n          ))}\n        </tbody>\n      </table>\n      <button\n        onClick={handleLogout}\n        className=\"bg-red-500 text-white px-4 py-2 rounded hover:bg-red-600 transition duration-200 mt-4\">\n        Atsijungti\n      </button>\n    </div>\n  );\n}"],"names":[],"mappings":"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","debugId":null}}]
}